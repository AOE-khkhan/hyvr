<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>HyVR Computational methods &#8212; HYVR 0.2 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="HYVR 0.2 documentation" href="index.html" />
    <link rel="next" title="HyVR inputs and outputs" href="inout.html" />
    <link rel="prev" title="Introduction" href="intro.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="inout.html" title="HyVR inputs and outputs"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="intro.html" title="Introduction"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">HYVR 0.2 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="hyvr-computational-methods">
<h1>HyVR Computational methods<a class="headerlink" href="#hyvr-computational-methods" title="Permalink to this headline">¶</a></h1>
<p>The first step in the HyVR algorithm is to load the model parameters, as defined in the <code class="docutils literal"><span class="pre">*.ini</span></code> initialisation file. Major strata contact surfaces are generated first. Architectural element contact surfaces are then simulated within each stratum, either based on input parameters or loaded from a user-defined lookup table of mean contact surface depths. The external and internal geometries of hydrofacies assemblages and associated hydrofacies are then simulated within each architectural element. Finally, microstructure within the features is simulated.</p>
<div class="figure align-center" id="id10">
<span id="hfm"></span><a class="reference internal image-reference" href="_images/hfm.png"><img alt="_images/hfm.png" src="_images/hfm.png" style="width: 30%;" /></a>
<p class="caption"><span class="caption-text"><em>Hierarchical modeling framework implemented in HyVR.</em></span></p>
</div>
<p><em>Note that in this section model input parameters are denoted in the following manner:</em> <code class="docutils literal"><span class="pre">parameter-section.parameter</span></code>.</p>
<div class="section" id="simulation-of-strata-and-architectural-element-contact-surfaces">
<h2>Simulation of strata and architectural element contact surfaces<a class="headerlink" href="#simulation-of-strata-and-architectural-element-contact-surfaces" title="Permalink to this headline">¶</a></h2>
<p>Strata are defined in the input parameter file by their upper mean elevations and the architectural elements that are to be included within them. The upper contact surface is then generated and all model cells between the lower and upper contact surface are assigned to the stratum.</p>
<p>Contact surfaces can either be flat or random. Multi-Gaussian random contact surfaces are generated using the spectral methods outlined by <a class="reference internal" href="references.html#dietrich1993" id="id1">[DN93]</a>.  These methods require structural statistical parameters (i.e. mean and variance) for the quantity of interest, and a geostatistical covariance model. We used a Gaussian covariance model in the present study to produce smoothly varying surfaces:</p>
<p><span class="math">\(R_{ss}(h)=\sigma^2_s \exp\left[ - \left[ \frac{\Delta x}{\lambda}\right]^2 \right]\)</span></p>
<p>where <span class="math">\(s\)</span> is the random quantity of interest, <span class="math">\(\sigma^2_s\)</span> is the variance of <span class="math">\(s\)</span> (here elevation), <span class="math">\(\Delta x\)</span> is the distance between the two points, and <span class="math">\(\lambda\)</span> is the correlation length.</p>
<p>Simulation at the architectural element hierarchical level begins once all strata units have been assigned. Architectural elements are defined using a lookup table with the following information:</p>
<table border="1" class="docutils">
<colgroup>
<col width="28%" />
<col width="18%" />
<col width="16%" />
<col width="22%" />
<col width="16%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Architectural element identifier</td>
<td>Mean bottom elevation</td>
<td>Mean top elevation</td>
<td>Architectural element type</td>
<td>Strata   identifier</td>
</tr>
</tbody>
</table>
<p>If the architectural element lookup table is not defined before initialising the simulation, then the architectural elements will be simulated based on input parameters defined for each stratum. This starts with the random choice of an architectural element from those defined; the probability of each architectural element being chosen is also defined in the input parameter file. The thickness of the architectural element is then drawn from a random normal distribution that is defined for each stratum in the input parameter file. To account for the erosive nature of many sedimentary environments the algorithm may erode the underlying units: here the &#8216;avulsion&#8217; thickness <span class="math">\(th_{avulsion}\)</span> is subtracted from the bottom and top of the architectural element <span class="math">\(z^{bot}_{AE}, z^{top}_{AE}\)</span>. Once the architectural element lookup table has been defined,  contact surfaces are generated using the same procedure as used for strata contact surfaces. When the architectural element have been generated, the algorithm begins to simulate external hydrofacies assemblage geometries and hydrofacies.</p>
</div>
<div class="section" id="simulation-of-hydrofacies-assemblages-and-hydrofacies-geometries">
<h2>Simulation of hydrofacies assemblages and hydrofacies geometries<a class="headerlink" href="#simulation-of-hydrofacies-assemblages-and-hydrofacies-geometries" title="Permalink to this headline">¶</a></h2>
<p>The generation of hydrofacies assemblages and internal hydrofacies occurs stratum- and architectural-element-wise, beginning with the lowest architectural element in the lowest stratum. The simulation of individual hydrofacies assemblages is object-based, with random placement of features within the architectural element. Object-based methods have been implemented widely in subsurface simulation <a class="reference internal" href="references.html#jussel1994" id="id2">[JSD94]</a><a class="reference internal" href="references.html#bennett2017" id="id3">[BHC17]</a> as they are generally computationally efficient and relatively easy to parameterize. The HyVR program approximates hydrofacies assemblages with simple geometric shapes. Currently, three <a class="reference internal" href="#shapes">shapes</a> are supported: truncated ellipsoids, extruded parabolas, and sheets. Truncated ellipsoids and extruded parabolas are &#8216;erosive&#8217; hydrofacies assemblages: this means that within the HyVR algorithm they are able to erode underlying units, and therefore the architectural element (and strata) boundaries may be altered during the course of the simulation.</p>
<div class="figure align-center" id="id11">
<span id="shapes"></span><a class="reference internal image-reference" href="_images/hyvr_geometries.png"><img alt="_images/hyvr_geometries.png" src="_images/hyvr_geometries.png" style="width: 75%;" /></a>
<p class="caption"><span class="caption-text"><em>Geometries implemented in HyVR.</em></span></p>
</div>
<p>Four properties are assigned to each model grid cell during this simulation step: <em>ae</em>, <em>ha_arr</em>, <em>hat_arr</em>, <em>facies</em>, <em>azimuth</em>, and <em>dip</em>. The <em>ae</em> property denotes which architectural element (from <code class="docutils literal"><span class="pre">strata.l_ae</span></code>) has been assigned to a model grid cell. The <em>ha_arr</em> property is the unique identifier for each individual hydrofacies assemblage generated. <em>hat_arr</em> denotes the type of hydrofacies assemblage within the model grid cell is located. The <em>facies</em> property denotes which hydrofacies has been assigned to a model grid cell. The <em>azimuth</em> <span class="math">\(\kappa\)</span> and <em>dip</em> <span class="math">\(\psi\)</span> properties are associated with the bedding structure at each model grid cell and denote the angle of the bedding plane from the mean direction of flow and horizontal, respectively.</p>
<div class="section" id="truncated-ellipsoids">
<span id="temethod"></span><h3>Truncated ellipsoids<a class="headerlink" href="#truncated-ellipsoids" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>Truncated ellipsoids are generated as a proxy for trough-like features. The method for generating the boundaries of these features has been described previously in <a class="reference internal" href="references.html#bennett2017" id="id4">[BHC17]</a>. Generation starts at <span class="math">\(z^{bot}_{AE unit} +AE_{depth}\cdot\beta\)</span> where <span class="math">\(AE_{depth}\)</span> is the depth of the truncated ellipsoid geometry, and <span class="math">\(\beta\)</span> is a buffer term that allows the user to control how much of the underlying unit is eroded. The centre of the truncated ellipsoid (<span class="math">\(x,y\)</span> coordinates) and the paleoflow angle <span class="math">\(\alpha\)</span> (i.e. major ellipsoid axis orientation) are drawn from a random uniform distribution and the boundary of the truncated ellipsoid is simulated. The <a class="reference internal" href="#internal-structure">internal structure</a> of truncated ellipsoids can be defined in the following ways:</dt>
<dd><ul class="first last simple">
<li>trough-wise homogeneous, with constant azimuth and dip;</li>
<li>bulb-dip, with azimuth and dip values based on the three-dimensional gradient at the ellipsoid boundary (&#8216;bulb dip&#8217;);</li>
<li>bulb-sets, comprising nested alternating hydrofacies with <span class="math">\(\kappa\)</span> and <span class="math">\(\psi\)</span> values generated as for bulb-type;</li>
<li>dip-sets internal structure, where the features have a constant <span class="math">\(\kappa\)</span> and <span class="math">\(\psi\)</span> but the assigned hydrofacies alternate throughout the truncated ellipsoid.</li>
</ul>
</dd>
</dl>
<div class="figure align-center" id="id12">
<span id="structure"></span><a class="reference internal image-reference" href="_images/internal_structure_lowres.png"><img alt="_images/internal_structure_lowres.png" src="_images/internal_structure_lowres.png" style="width: 75%;" /></a>
<p class="caption"><span class="caption-text"><em>Internal structure of truncated ellipsoid hydrofacies assemblages.</em></span></p>
</div>
<p>Once a truncated ellipsoid has been generated, an aggradation thickness (<code class="docutils literal"><span class="pre">trunc_ellip.agg</span></code>) is added to the current simulation elevation <span class="math">\(z_{sim}\)</span> and the next assemblage is simulated. This occurs until <span class="math">\(z_{sim} = z^{top}_{AE}\)</span>.</p>
<p><a class="reference internal" href="inout.html#teparams"><span class="std std-ref">Truncated ellipsoid parameters</span></a></p>
<div class="section" id="bulb-dip">
<h4>Bulb dip<a class="headerlink" href="#bulb-dip" title="Permalink to this headline">¶</a></h4>
<p>Bulb hydrofacies assemblages is simulated by calculating the three-dimensional gradient at the boundary of the truncated ellipsoid and then the angle between the gradient and a horizontal plane. This angle is then compared with a &#8216;maximum dip angle&#8217; (<code class="docutils literal"><span class="pre">r_dip</span></code>) and the smaller of these two values is assigned to all model grid cells within the hydrofacies assemblage with equivalent <span class="math">\(x,y\)</span>-coordinates (i.e. column-wise).</p>
</div>
<div class="section" id="bulb-sets">
<h4>Bulb sets<a class="headerlink" href="#bulb-sets" title="Permalink to this headline">¶</a></h4>
<p>Nested-bulb-like layers are simulated by subdividing the depth of the truncated ellipsoid into a series with a set thickness <code class="docutils literal"><span class="pre">trunc_ellip.bulbset_d</span></code>. Truncated ellipsoids are simulated consecutively with the same center point and paleoflow <span class="math">\(\alpha\)</span> value, starting with the deepest assemblage. With each simulation, a scaling factor is calculated by dividing the new depth with the total depth of the assemblage. This scaling factor is applied to the length and width parameters of the truncated ellipsoid. Each newly generated ellipsoid subsumes the previous. Each nested assemblage represents a constant hydrofacies, however the orientation of these hydrofacies may differ within the entire hydrofacies assemblage, to create bulb-like features that have been reported in the field. The dip of the nested ellipsoids defaults to that determined by the three-dimension gradient at the nested-ellipsoid boundary.</p>
</div>
<div class="section" id="dip-sets">
<h4>Dip sets<a class="headerlink" href="#dip-sets" title="Permalink to this headline">¶</a></h4>
<p>Refer to <a class="reference internal" href="#dipset"><span class="std std-ref">dipset section</span></a> section.</p>
</div>
</div>
<div class="section" id="extruded-parabolas">
<h3>Extruded parabolas<a class="headerlink" href="#extruded-parabolas" title="Permalink to this headline">¶</a></h3>
<p>Parabolas extruded along arbitrary curves with variable sinuosity are useful to represent channels. Extruded parabola centrelines in HyVR are parameterized using the disturbed periodic model implemented by <a class="reference internal" href="references.html#ferguson1976" id="id5">[Fer76]</a>:</p>
<p><span class="math">\(\theta + \frac{2h}{k} \frac{d\theta}{ds} + \frac{1}{k^2} \frac{d^2\theta}{ds^2}  = \epsilon(s)\)</span></p>
<p>with curve direction <span class="math">\(\theta\)</span>, damping factor <span class="math">\(h \in [0,1]\)</span>, <span class="math">\(k = 2\pi/\lambda\)</span> is the wavenumber with <span class="math">\(\lambda\)</span> the frequency of the undamped sine wave, and <span class="math">\(s\)</span> is the distance along the curve. This model can be approximated using the following second-order autoregressive model described in Equation 15 of <a class="reference internal" href="references.html#ferguson1976" id="id6">[Fer76]</a>:</p>
<p><span class="math">\(\theta_i - b_1 \theta_{i-1} - b_2\theta{i-2} = \epsilon_i\)</span></p>
<p>with:
<span class="math">\(b_1 = 2e^{-kh}\cos(k\arcsin(h))\)</span>
<span class="math">\(b_2 = -e^{-2kh}\)</span></p>
<p>This method was also used by <a class="reference internal" href="references.html#pyrcz2009" id="id7">[PBD09]</a> for the simulation of alluvial depositional features. Model grid cells are assigned to the extruded parabola if the following conditions are met:</p>
<p><span class="math">\(D^2 \leqslant \frac{w^2_{ch}}{4} - \left[ \frac{(z_{ch} - z_{cell})\cdot\Delta z \cdot w_{ch}}{d_{ch}} \right] ^2 \; \wedge \; z_{cell} \leqslant z_{ch}\)</span></p>
<p>where <span class="math">\(D^2\)</span> is the two-dimensional (<span class="math">\(x,y\)</span>) distance from the cell to the extruded parabola centerline, <span class="math">\(w_{ch}\)</span> and <span class="math">\(d_{ch}\)</span> are the extruded parabola width and depth respectively, <span class="math">\(z_{ch}\)</span> and <span class="math">\(z_{cell}\)</span> are the elevations of the extruded parabola top and node respectively, and <span class="math">\(\Delta z\)</span> is the model grid cell <span class="math">\(z\)</span> dimension. Two-dimensional &#8216;channel velocities&#8217; <span class="math">\(\vec{v}\)</span> are evaluated at the centerline and then interpolated to grid cells using an inverse-distance-weighted interpolation. Azimuth values are calculated by taking the arctangent of the two-dimensional channel velocity at a given point. Dip values of grid cells within the extruded parabola are assigned based on input parameters. If alternating hydrofacies are to be simulated they are constructed by creating planes that are evenly spaced along the extruded parabola centerline.</p>
<p>The HyVR algorithm generates extruded parabolas starting from <span class="math">\(z^{bot}_{AE unit} +AE_{depth}\cdot\beta\)</span>, as for truncated ellipsoids. However, to account for the multiple extruded parabolas that are often concurrently present in many river systems, multiple extruded parabolas can be generated at each simulation depth (<code class="docutils literal"><span class="pre">ext_par.channel_no</span></code>). The starting <span class="math">\(x,y\)</span> coordinates for the centerlines are drawn from a random uniform distribution such that <span class="math">\(x\in[-50,0]\)</span> and <span class="math">\(y\in[0,Y]\)</span>. Extruded parabola geometries are then assigned sequentially to the model grid cells; note that in HyVR there is no interaction of extruded parabolas, and subsequent extruded parabolas will supersede (or &#8216;erode&#8217;) those previously generated.  Once the predefined number of extruded parabolas stipulated by <code class="docutils literal"><span class="pre">ext_par.channel_no</span></code> has been simulated a three-dimensional migration vector <code class="docutils literal"><span class="pre">ext_par.r_mig</span></code> is added to the extruded parabola centerlines and the extruded parabola assignment to model grid cells begins again. The reuse of the extruded parabola centerline trajectories is more efficient than re-simulating these values at each <span class="math">\(z_{sim}\)</span>. This continues until  <span class="math">\(z_{sim} = z^{top}_{seq}\)</span>.</p>
<p><a class="reference internal" href="inout.html#chparams"><span class="std std-ref">Extruded parabola parameters</span></a></p>
</div>
<div class="section" id="sheets">
<h3>Sheets<a class="headerlink" href="#sheets" title="Permalink to this headline">¶</a></h3>
<p>Sheets are comparatively simple to generate as they are laterally continuous across the entire model domain (depending on strata boundaries). The internal structure of sheet features may be massive (i.e. without internal structure), or laminations can be generated.  In the HyVR algorithm laminations are simulated sequentially by assigning all model grid cells between a specific elevation interval the appropriate hydrofacies codes. Dipping set structures can also be incorporated into these features. Sheets may differ in internal orientation, as specified in the input parameters.</p>
<p><a class="reference internal" href="inout.html#shparams"><span class="std std-ref">Sheet parameters</span></a></p>
</div>
<div class="section" id="internal-structure">
<h3>Internal structure<a class="headerlink" href="#internal-structure" title="Permalink to this headline">¶</a></h3>
<p>The internal structure of the hydrofacies assemblages is distinguished by hydrofacies. The internal structure of an hydrofacies assemblage may be homogeneous, dipping or elliptsoidal (for truncated ellipsoid only). Additionally, lag surfaces composed of different hydrofacies may be simulated in erosive (i.e. extruded parabola, truncated ellipsoid) hydrofacies assemblage.</p>
<div class="section" id="dipset">
<span id="id8"></span><h4>Dipset<a class="headerlink" href="#dipset" title="Permalink to this headline">¶</a></h4>
<p>Architectural elements may be populated with dipping hydrofacies structures. Such structures are generated by creating planes at regular intervals throughout the architectural element, as defined by <code class="docutils literal"><span class="pre">element.dipset_d</span></code>. In truncated ellipsoids the planes are constructed along the centerline of the element, perpendicular to the paleoflow angle <span class="math">\(\alpha\)</span>. In extruded parabola elements, the planes are constructed along the centerline and are perpendicular to <span class="math">\(\vec{v}(x)\)</span>. The distance from the centre of each model grid cell to all planes is calculated and then the model grid cells between planes are assigned a hydrofacies value.</p>
</div>
<div class="section" id="lag-surfaces">
<h4>Lag surfaces<a class="headerlink" href="#lag-surfaces" title="Permalink to this headline">¶</a></h4>
<dl class="docutils">
<dt>Lag surfaces can be set for erosive hydrofacies assemblages by setting the <code class="docutils literal"><span class="pre">element.l_lag</span></code> parameter. This parameter consists of two values:</dt>
<dd><ul class="first last simple">
<li>The thickness of the lag surface from the element base; and</li>
<li>The hydrofacies identifier to be assigned.</li>
</ul>
</dd>
</dl>
<p>Lag surfaces cannot have any internal dipping structure.</p>
</div>
<div class="section" id="alternating-hydrofacies">
<h4>Alternating hydrofacies<a class="headerlink" href="#alternating-hydrofacies" title="Permalink to this headline">¶</a></h4>
<p>Sedimentary deposits can often exhibit cyclicity in their features; therefore, HyVR allows alternating hydrofacies to be simulated. This is controlled by sequentially assigning hydrofacies within each hydrofacies assemblage, starting with a hydrofacies randomly selected from those to be simulated in the architectural element (<code class="docutils literal"><span class="pre">element.l_facies</span></code>). The hydrofacies which is assigned next is drawn from a subset of hydrofacies specified in the <code class="docutils literal"><span class="pre">element.ll_altfacies</span></code> input parameter. For each hydrofacies in <code class="docutils literal"><span class="pre">element.l_facies</span></code>, a list of alternating hydrofacies (i.e., which hydrofacies can follow the present one) is stipulated. By only specifying one hydrofacies ID in the <code class="docutils literal"><span class="pre">element.ll_altfacies</span></code>, it guarantees that that ID will be selected. The figure below gives three examples of different input parameters.</p>
<div class="figure align-center" id="id13">
<span id="altfac"></span><a class="reference internal image-reference" href="_images/altfac.png"><img alt="_images/altfac.png" src="_images/altfac.png" style="width: 55%;" /></a>
<p class="caption"><span class="caption-text"><em>Variations on alternating hydrofacies in architectural elements</em></span></p>
</div>
</div>
</div>
<div class="section" id="linear-trends">
<h3>Linear trends<a class="headerlink" href="#linear-trends" title="Permalink to this headline">¶</a></h3>
<p>The HyVR algorithm  allows for linear trends in geometry sizes with increasing elevation by setting the <code class="docutils literal"><span class="pre">element.r_geo_ztrend</span></code> parameter. This parameter comprises a bottom and top factor <span class="math">\(\xi_{bottom},\xi_{top}\)</span> that multiply the usual geometry dimensions. For intermediate elevations the <span class="math">\(z\)</span> factor is calculated through a linear interpolation of <span class="math">\(\xi_{bottom},\xi_{top}\)</span>. The parameters of each geometry may be set for each individual architectural element included in the model parameter file.</p>
</div>
</div>
<div class="section" id="simulation-of-hydraulic-parameters">
<h2>Simulation of hydraulic parameters<a class="headerlink" href="#simulation-of-hydraulic-parameters" title="Permalink to this headline">¶</a></h2>
<p>Hydraulic parameters are simulated once all features have been generated. The distributed hydraulic parameter outputs of HyVR are: the isotropic hydraulic conductivity <span class="math">\(K_{iso}(x,y,z)\)</span>; porosity <span class="math">\(\theta(x,y,z)\)</span>; and the full hydraulic conductivity tensor <span class="math">\(\textbf{K}(x,y,z)\)</span>, defined for each model grid cell.</p>
<p>Microstructure of hydraulic parameters is first simulated for each individual hydrofacies assemblage (as present in the <code class="docutils literal"><span class="pre">mat</span></code> storage array)  simulated in the previous steps. Spatially varying <span class="math">\(\ln(K_{iso})\)</span> and <span class="math">\(\theta\)</span> fields are generated for each hydrofacies present in an hydrofacies assemblage using spectral methods to simulate random multi-Gaussian fields with an exponential covariance model:</p>
<p><span class="math">\(R_{ss}(h)=\sigma^2_s \exp\left[ - \left| \frac{\Delta x}{\lambda}\right| \right]\)</span></p>
<p>An anisotropic ratio is also assigned to each model grid cell according to the hydrofacies present; these ratios are globally constant for each hydrofacies.</p>
<p>Microstructure may also be assigned to model grid cells that are not within hydrofacies assemblage. This background heterogeneity is simulated for each architectural element using values defined for each architectural element type (<code class="docutils literal"><span class="pre">element.r_bg</span></code>). Simulation methods are the same as for within-assemblage heterogeneity.</p>
<p>Spatial trends may also be applied once isotropic hydraulic-conductivity values have been assigned to all model grid cells. As for trends in hydrofacies assemblage geometry, trends are assigned using a linearly-interpolated factor <span class="math">\(\xi_{start},\xi_{end}\)</span> in the <span class="math">\(x\)</span>- and/or <span class="math">\(z\)</span>-directions. The value of each model grid cell is then multiplied by the trend factors.</p>
<div class="section" id="hydraulic-conductivity-tensors">
<span id="tensorgen"></span><h3>Hydraulic-conductivity tensors<a class="headerlink" href="#hydraulic-conductivity-tensors" title="Permalink to this headline">¶</a></h3>
<p>Full hydraulic-conductivity tensors for each model grid cell are  calculated by multiplying the isotropic hydraulic conductivity <span class="math">\(K^{iso}\)</span>, with a rotated anisotropy matrix <span class="math">\(\textbf{M}\)</span>:</p>
<p><span class="math">\(\textbf{K}_i =K^{iso}_i\textbf{R}_i\textbf{M}_i\textbf{R}_i^T\)</span></p>
<p><span class="math">\(\textbf{R}_i = \begin{bmatrix} \cos(\kappa_i)\cos(\psi_i) &amp; \sin(\kappa_i) &amp; \cos(\kappa_i)\sin(\psi_i)\\ -\sin(\kappa_i)\cos(\psi_i) &amp; \cos(\kappa_i) &amp; -\sin(\kappa_i)\sin(\psi_i)\\ -\sin(\psi_i) &amp; 0 &amp; \cos(\psi_i) \end{bmatrix}\)</span></p>
<p>Parameters <span class="math">\(\psi_i\)</span> and <span class="math">\(\kappa_i\)</span> are the simulated bedding structures (dip and azimuth, respectively). The anisotropy matrix <span class="math">\(\textbf{M}_i\)</span> is diagonal with lateral terms set as equivalent (i.e. <span class="math">\(K_{xx} = K_{yy}\)</span>). This approach is identical to that of <a class="reference internal" href="references.html#bennett2017" id="id9">[BHC17]</a>. Once this has been completed, the simulated parameter files are saved and can be used for groundwater flow and solute transport simulations.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">HyVR Computational methods</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#simulation-of-strata-and-architectural-element-contact-surfaces">Simulation of strata and architectural element contact surfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="#simulation-of-hydrofacies-assemblages-and-hydrofacies-geometries">Simulation of hydrofacies assemblages and hydrofacies geometries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#truncated-ellipsoids">Truncated ellipsoids</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bulb-dip">Bulb dip</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bulb-sets">Bulb sets</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dip-sets">Dip sets</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#extruded-parabolas">Extruded parabolas</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sheets">Sheets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#internal-structure">Internal structure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dipset">Dipset</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lag-surfaces">Lag surfaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="#alternating-hydrofacies">Alternating hydrofacies</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#linear-trends">Linear trends</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#simulation-of-hydraulic-parameters">Simulation of hydraulic parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hydraulic-conductivity-tensors">Hydraulic-conductivity tensors</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="inout.html">HyVR inputs and outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="example.html">HyVR Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="more.html">Extending HyVR</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">HyVR package</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog/Bug Fixes</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="intro.html"
                        title="previous chapter">Introduction</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="inout.html"
                        title="next chapter">HyVR inputs and outputs</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/methods.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="inout.html" title="HyVR inputs and outputs"
             >next</a> |</li>
        <li class="right" >
          <a href="intro.html" title="Introduction"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">HYVR 0.2 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017-2018, Jeremy Bennett.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.6.
    </div>
  </body>
</html>